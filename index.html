<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Agentic Honeypot</title>
<style>
body { font-family: Arial; background: #f7f7f7; padding: 20px; }
.container { display: flex; gap: 20px; }
.panel { background: white; padding: 20px; border-radius: 10px; width: 50%; }
.bubble { padding: 12px; margin: 8px 0; border-radius: 10px; }
.red { background: #ffe3e3; }
.green { background: #e3ffe9; }
button { margin: 5px; }
</style>
</head>

<body>

<h2>Agentic Honeypot â€” Scam Interaction Simulator</h2>

<div class="scenarios">
<button onclick="sendScenario('otp')">ğŸ¦ OTP Scam</button>
<button onclick="sendScenario('upi')">ğŸ“² UPI Fraud</button>
<button onclick="sendScenario('kyc')">ğŸªª KYC Expiry</button>
<button onclick="sendScenario('lottery')">ğŸ‰ Lottery</button>
</div>

<div class="container">
<div class="panel">
<div id="chat"></div>

<input id="input" placeholder="Type scammer message..." style="width:80%">
<button onclick="send()">Send</button>
<p id="confidence"></p>
</div>

<div class="panel">
<h4>Extracted Intelligence</h4>
<pre id="intel">{}</pre>
</div>
</div>

<script>
const API_URL = "https://agentic-honeypot-grbb.onrender.com/message";
const API_KEY = "N!m!$#@3reddy";
let history = [];

const SCENARIOS = {
  otp: "Urgent call from SBI. Share OTP now",
  upi: "Send â‚¹5000 to demo.user@upi",
  kyc: "Your KYC expires today. Verify immediately",
  lottery: "You won â‚¹25 lakh. Pay processing fee"
};

function sendScenario(type) {
  document.getElementById("input").value = SCENARIOS[type];
  send();
}

async function send() {
  const msg = document.getElementById("input").value;
  document.getElementById("input").value = "";

  const res = await fetch(API_URL, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "x-api-key": API_KEY
    },
    body: JSON.stringify({
      conversation_id: "demo",
      message: msg,
      history
    })
  });

  const data = await res.json();
  history = data.memory;

  renderChat(history);
  document.getElementById("intel").innerText =
    JSON.stringify(data.extracted_intelligence, null, 2);

  document.getElementById("confidence").innerText =
    "Scam Confidence: " + data.confidence_score + "%";
}

function renderChat(memory) {
  const chat = document.getElementById("chat");
  chat.innerHTML = "";

  memory.forEach(m => {
    const div = document.createElement("div");
    div.className = "bubble " + (m.role === "scammer" ? "red" : "green");
    div.innerText = m.content;
    chat.appendChild(div);
  });
}
</script>
</body>
</html>
